function updateScroll() {
    var e = document.getElementById("chats");
    e.scrollTop = e.scrollHeight
}
var token, ws = new WebSocket("ws://gym.crossfit.htb/ws/"),
    pingTimeout = setTimeout(() => {
        ws.close(), $(".chat-main").remove()
    }, 31e3);

function check_availability(e) {
    var s = new Object;
    s.message = "available", s.params = String(e), s.token = token, ws.send(JSON.stringify(s))
}
$(".chat-content").slideUp(), $(".hide-chat-box").click(function() {
    $(".chat-content").slideUp()
}), $(".show-chat-box").click(function() {
    $(".chat-content").slideDown(), updateScroll()
}), $(".close-chat-box").click(function() {
    $(".chat-main").remove()
}), ws.onopen = function() {}, ws.onmessage = function(e) {
    "ping" === e.data ? (ws.send("pong"), clearTimeout(pingTimeout)) : (response = JSON.parse(e.data), answer = response.message, answer.startsWith("Hello!") && $("#ws").show(), token = response.token, $("#chat-messages").append('<li class="receive-msg float-left mb-2"><div class="receive-msg-desc float-left ml-2"><p class="msg_display bg-white m-0 pt-1 pb-1 pl-2 pr-2 rounded">' + answer + "</p></div></li>"), updateScroll())
}, $("#sendmsg").on("keypress", function(e) {
    if (13 === e.which) {
        $(this).attr("disabled", "disabled");
        var s = $("#sendmsg").val();
        if ("" !== s) {
            $("#chat-messages").append('<li class="send-msg float-right mb-2"><p class="msg_display pt-1 pb-1 pl-2 pr-2 m-0 rounded">' + s + "</p></li>");
            var t = new Object;
            t.message = s, t.token = token, ws.send(JSON.stringify(t)), $("#sendmsg").val(""), $(this).removeAttr("disabled"), updateScroll()
        }
    }
});